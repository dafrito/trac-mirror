<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="layout.html" />
  <head>
    <title>Settings</title>
  </head>

  <body>
    <div id="ctxtnav" class="nav"></div>

    <div id="content" class="settings">

      <h1>Settings and Session Management</h1>

      <h2>User Settings</h2>
      <p>This page lets you customize your personal settings for this site.
      These settings are stored on the server and are identified by a
      <em>session key</em> stored in a browser cookie. That cookie allows
      your settings to be restored on subsequent visits.</p>

      <form method="post" action="">
        <fieldset>
          <legend>Personal Information</legend>
          <div class="field">
            <label>Full name:
              <input type="text" name="name" size="30"
                     value="${settings.session.name}" />
            </label>
          </div>
          <div class="field">
            <label>Email address:
              <input type="text" name="email" size="30"
                     value="${settings.session.email}" />
            </label>
          </div>
          <p py:choose="" class="hint">
            <py:when test="req.authname == 'anonymous'">
              This information is used to automatically populate some forms
              on this site with your contact details.
            </py:when>
            <py:otherwise>
              This information is used to associate your login name with your
              email address and full name, which is used for email
              notification and RSS feeds, for example.
            </py:otherwise>
          </p>
        </fieldset>

        <fieldset>
          <legend>Preferences</legend>
          <div class="field">
            <label>Time zone:
              <select name="tz" id="tz">
                <option>Default time zone</option>
                <option py:for="tz in timezones"
                  selected="${settings.session.tz == tz or None}"
                  py:content="tz" />
              </select>
            </label>
            <p class="hint">Configuring your time zone will result in all
            dates and times displayed on this site to use your time zone
            instead of that of the server.</p>
          </div>
        </fieldset>

        <fieldset py:if="settings.session_id">
          <legend>Session</legend>
          <div class="field">
            <label>Session key:
              <input type="text" name="newsid" size="30"
                     value="${settings.session_id}" />
            </label>
            <p class="hint">The session key is used to identify stored custom
            settings and session data on the server. Although it is
            automatically generated by default, you may change it to something
            easier to remember at any time if you wish to load your settings
            in a different web browser.</p>
          </div>
        </fieldset>

        <div class="buttons">
          <input type="hidden" name="action" value="save" />
          <input type="submit" value="Submit changes" />
        </div >
      </form>

      <py:if test="settings.session_id">
        <hr />
        <h2>Load Session</h2>
        <p>You may load a previously created session by entering the
        corresponding session key below. This lets you share settings between
        multiple computers and web browsers.</p>

        <form method="post" action="">

          <fieldset>
            <legend>Session</legend>
            <div class="field">
              <label>Session key:
                <input type="text" name="loadsid" size="30" value="" />
              </label>
            </div>
          </fieldset>

          <div class="buttons">
            <input type="hidden" name="action" value="load" />
            <input type="submit" value="Restore session" />
          </div >

        </form>
      </py:if>

    </div>
  </body>
</html>
